---
phase: 05-recording-history
plan: 02
type: execute
wave: 2
depends_on: ["05-01"]
files_modified:
  - src/components/RecordingList.tsx
  - src/components/RecordingControls.tsx
  - src/App.tsx
autonomous: false
---

<objective>
Build recording list UI and integrate with existing app.

Purpose: Let users see past recordings with metadata and delete them to free space.
Output: Working recording history UI accessible from the main app.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
@~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/05-recording-history/05-01-SUMMARY.md

@src/hooks/useRecordingHistory.ts
@src/types/recording.ts
@src/components/RecordingControls.tsx
@src/App.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create RecordingList component</name>
  <files>src/components/RecordingList.tsx</files>
  <action>
Create a modal/drawer component for displaying recording history:

**Props:**
```typescript
interface RecordingListProps {
  isOpen: boolean;
  onClose: () => void;
  recordings: StoredRecording[];
  onDelete: (id: number) => Promise<void>;
  storageStats: { count: number; totalSize: number };
  isLoading: boolean;
}
```

**UI structure:**
1. Modal overlay (dark semi-transparent background, click to close)
2. Content panel (white/dark card, max-height with scroll)
3. Header: "Recordings" title + close button + storage stats (e.g., "3 recordings · 45 MB")
4. List of recordings, each showing:
   - Thumbnail placeholder (gray box with video icon)
   - Date/time formatted (e.g., "Jan 16, 2026 3:45 PM")
   - Duration formatted (e.g., "2:34")
   - File size formatted (e.g., "15.2 MB")
   - Delete button (trash icon, red on hover)
5. Empty state: "No recordings yet" message
6. Loading state: Spinner or skeleton

**Styling:**
- Follow existing Tailwind patterns from RecordingControls
- Dark theme consistent with app (gray-800/900 backgrounds)
- Responsive: Full-screen on mobile, centered modal on desktop

**Delete behavior:**
- Confirm dialog before delete: "Delete this recording? This cannot be undone."
- Show loading state while deleting

**Helpers:**
- `formatFileSize(bytes: number)`: Returns "1.5 MB", "850 KB", etc.
- `formatDate(date: Date)`: Returns "Jan 16, 2026 3:45 PM"
  </action>
  <verify>npm run build succeeds</verify>
  <done>RecordingList component renders list with delete functionality</done>
</task>

<task type="auto">
  <name>Task 2: Integrate recording history into app</name>
  <files>src/components/RecordingControls.tsx, src/App.tsx</files>
  <action>
**In App.tsx:**
1. Import and use `useRecordingHistory` hook
2. Add state: `showRecordingList: boolean`
3. After a recording is stopped and user clicks download, also offer to save to history
4. Pass recording history props to new RecordingList component
5. Render RecordingList when showRecordingList is true

**In RecordingControls.tsx:**
1. Add new prop: `onSave?: () => void` - callback when save button clicked
2. Add new prop: `onShowHistory?: () => void` - callback to open history
3. When recording is stopped, show a "Save" button next to Download button
4. Add a "History" button (folder/list icon) that's always visible in bottom-left area
5. History button shows badge with recording count if > 0

**UI flow:**
1. User records → stops → sees Download + Save buttons
2. Clicking Save stores to IndexedDB (via onSave callback)
3. History button opens RecordingList modal
4. User can view/delete past recordings

**Button styling:**
- Save button: Green (success color), same size as download button
- History button: Gray, positioned after record button
  </action>
  <verify>npm run build succeeds</verify>
  <done>Recording history accessible from main UI, save/view/delete works</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Recording history feature with IndexedDB persistence, list UI, and delete functionality</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Visit: http://localhost:5173 (or the Vite port shown)
    3. Enter password to access app
    4. Record a short video (5-10 seconds)
    5. Click Stop, then click "Save" button
    6. Click the History button (should show "1" badge)
    7. Verify: Recording appears in list with date, duration, file size
    8. Refresh the page
    9. Verify: Recording persists (still shows in history)
    10. Open history, click delete on a recording
    11. Confirm the delete dialog
    12. Verify: Recording is removed from list
    13. Verify: Storage stats update correctly
  </how-to-verify>
  <resume-signal>Type "approved" if all checks pass, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] Recording can be saved to IndexedDB
- [ ] Recording list displays with correct metadata
- [ ] Delete removes recording and updates list
- [ ] Data persists across page refresh
</verification>

<success_criteria>
- All tasks completed
- Human verified the recording history flow works end-to-end
- No TypeScript errors
- UI is responsive and follows existing styling patterns
</success_criteria>

<output>
After completion, create `.planning/phases/05-recording-history/05-02-SUMMARY.md`
</output>
