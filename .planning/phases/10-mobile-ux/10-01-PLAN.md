---
phase: 10-mobile-ux
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [src/components/CameraPreview.tsx, src/hooks/useFullscreen.ts]
autonomous: false
---

<objective>
Add fullscreen mode and orientation handling for improved mobile workout experience.

Purpose: When exercising on mobile, browser chrome takes valuable screen space. Fullscreen mode maximizes video area and orientation handling ensures smooth portrait/landscape transitions.

Output: Fullscreen toggle button, orientation-aware layout, better mobile UX during workouts.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
@~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@src/components/CameraPreview.tsx
@src/App.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create fullscreen hook and add toggle button</name>
  <files>src/hooks/useFullscreen.ts, src/components/CameraPreview.tsx</files>
  <action>
1. Create `src/hooks/useFullscreen.ts` with:
   - `isFullscreen` state (tracks current fullscreen status)
   - `toggleFullscreen()` function that calls `document.documentElement.requestFullscreen()` or `document.exitFullscreen()`
   - Handle vendor-prefixed APIs for Safari (`webkitRequestFullscreen`, `webkitExitFullscreen`)
   - Listen for `fullscreenchange` event to update state when user exits via Escape key
   - Return `{ isFullscreen, toggleFullscreen, isSupported }`

2. In CameraPreview.tsx:
   - Import and use `useFullscreen` hook
   - Add fullscreen toggle button near the camera switch button (bottom-right corner)
   - Use expand/compress icon based on `isFullscreen` state
   - Style: same pattern as camera switch button (gray-800/80 bg, rounded-full, shadow-lg)
   - Position: above camera switch button with appropriate gap
   - Only show button if `isSupported` is true
  </action>
  <verify>npm run build succeeds, no TypeScript errors</verify>
  <done>Fullscreen button visible on page, clicking it enters/exits fullscreen mode</done>
</task>

<task type="auto">
  <name>Task 2: Handle orientation changes gracefully</name>
  <files>src/components/CameraPreview.tsx</files>
  <action>
1. Add orientation state tracking:
   - Use `window.screen.orientation?.type` to detect current orientation
   - Listen for `orientationchange` event (or `screen.orientation.onchange` where supported)
   - Track orientation in component state: 'portrait' | 'landscape'

2. Adjust layout for orientation:
   - In landscape fullscreen: hide or minimize header elements to maximize video
   - In portrait fullscreen: keep current compact layout
   - The video container already uses object-cover which handles aspect ratio changes

3. Add subtle orientation hint when entering fullscreen in portrait:
   - Show brief toast/hint: "Rotate device for best view" (only on mobile, only in portrait)
   - Auto-dismiss after 3 seconds
   - Only show once per fullscreen session (use ref to track)

4. Safari-specific handling:
   - Safari iOS doesn't support Fullscreen API for non-video elements
   - Detect Safari mobile and show alternative: "Add to Home Screen for fullscreen"
   - Or gracefully degrade by just not showing fullscreen button on unsupported browsers
  </action>
  <verify>npm run build succeeds, no TypeScript errors, no console warnings about deprecated APIs</verify>
  <done>Orientation changes don't break layout, hint appears appropriately, Safari handled gracefully</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Fullscreen mode with orientation handling for mobile workouts</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Open on mobile device or Chrome DevTools mobile emulation

    Desktop/Chrome tests:
    3. Verify fullscreen button appears (expand icon near camera switch)
    4. Click fullscreen button - should enter fullscreen mode
    5. Verify controls remain accessible in fullscreen
    6. Press Escape or click button again - should exit fullscreen

    Mobile tests (if real device available):
    7. Open site on mobile browser
    8. Tap fullscreen button
    9. Rotate device - verify layout adjusts smoothly
    10. Verify "rotate for best view" hint appears in portrait

    Safari iOS test (if available):
    11. Verify graceful degradation - no broken button or errors
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] npm run build succeeds without errors
- [ ] useFullscreen hook handles all browser variants
- [ ] Fullscreen toggle works on desktop Chrome/Firefox/Edge
- [ ] Orientation changes don't break UI layout
- [ ] No console errors on mobile Safari
- [ ] Human verified on actual device or emulator
</verification>

<success_criteria>
- All tasks completed
- Fullscreen mode works on supported browsers
- Graceful degradation on unsupported browsers (Safari iOS)
- Layout remains usable in all orientations
- Human approved visual/functional verification
</success_criteria>

<output>
After completion, create `.planning/phases/10-mobile-ux/10-01-SUMMARY.md`
</output>
